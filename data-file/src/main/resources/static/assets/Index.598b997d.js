var e=Object.defineProperty,l=(l,t,a)=>(((l,t,a)=>{t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a})(l,"symbol"!=typeof t?t+"":t,a),a);import{h as t}from"./http.b0ffeadd.js";import{d as a,B as u,r as o,b as n,D as s,e as i,o as d,c,a as r,w as f,k as p,h as m,t as v,u as h,g,l as b,F as y,f as x,E as _,m as w,j as C,G as k,_ as D,s as T,z as S,A as U,H as I,i as M,n as N,I as V,p as E}from"./index.49f53232.js";import{l as F}from"./LoadFile.d35da526.js";var L=(e=>(e.XLSX=".xlsx",e.XLS=".xls",e.CSV=".csv",e.TXT=".txt",e.JSON=".json",e.DATA=".data",e))(L||{});const R={style:{width:"100%"}},z={style:{"text-align":"center","margin-top":"8px"}},H=m("确认配置信息"),A=m(" 下一项"),O={key:0,style:{width:"100%"}},B=a({name:"FileConfig",setup(e){const l=F(),{fileInfo:a,fileColumns:w}=u(l);let C=o();function k(){D({info:a.value,columns:w.value})}function D(e){C.value=null,t.post("/sysLoadFileInfo/readFile",e).then((e=>{200==e.code&&(w.value=e.data.columns,a.value=e.data.info,C.value=e.data.datas)})).catch((e=>{}))}function T(){D({info:a.value})}function S(){let e={info:a.value,columns:w.value};t.post("/sysLoadFileInfo/saveFileConfig",e).then((e=>{200==e.code&&_({message:e.data,type:"success"})})).catch((e=>{}))}return n((()=>{s((()=>{k()}))})),(e,l)=>{const t=i("el-descriptions-item"),u=i("el-input-number"),o=i("el-input"),n=i("el-switch"),s=i("el-descriptions"),_=i("el-button"),D=i("el-table-column"),U=i("el-table"),I=i("el-space");return d(),c("div",R,[r(I,{fill:!0,wrap:"",style:{width:"100%"}},{default:f((()=>[p("div",null,[r(s,{title:"文件信息",direction:"vertical",column:7,border:!0},{default:f((()=>[r(t,{label:"文件名称"},{default:f((()=>[m(v(h(a).fileName),1)])),_:1}),r(t,{label:"文件类型"},{default:f((()=>[m(v(h(a).fileType),1)])),_:1}),r(t,{label:"文件大小"},{default:f((()=>[m(v(h(a).fileSize),1)])),_:1}),r(t,{label:"跳过头行"},{default:f((()=>[r(u,{modelValue:h(a).skip,"onUpdate:modelValue":l[0]||(l[0]=e=>h(a).skip=e),min:0,onChange:k},null,8,["modelValue"])])),_:1}),h(a).fileType==h(L).TXT||h(a).fileType==h(L).CSV?(d(),g(t,{key:0,label:"分割符号"},{default:f((()=>[r(o,{modelValue:h(a).separator,"onUpdate:modelValue":l[1]||(l[1]=e=>h(a).separator=e),placeholder:"分割符号：通常以逗号','，'tab'分割字段",onChange:k},null,8,["modelValue"])])),_:1})):b("",!0),h(a).fileType==h(L).TXT||h(a).fileType==h(L).CSV?(d(),g(t,{key:1,label:"限定符号"},{default:f((()=>[r(o,{modelValue:h(a).enclosed,"onUpdate:modelValue":l[2]||(l[2]=e=>h(a).enclosed=e),placeholder:"限定符号:通常以单引号，双引号，反引号包围字段",onChange:k},null,8,["modelValue"])])),_:1})):b("",!0),r(t,{label:"首行标题"},{default:f((()=>[r(n,{modelValue:h(a).hasHead,"onUpdate:modelValue":l[3]||(l[3]=e=>h(a).hasHead=e),class:"ml-2","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"Y","inactive-text":"N","active-value":"Y","inactive-value":"N",onChange:T},null,8,["modelValue"])])),_:1})])),_:1}),p("div",z,[r(_,{type:"primary",onClick:S},{default:f((()=>[H])),_:1}),r(_,{type:"primary",onClick:l[4]||(l[4]=l=>e.$emit("next"))},{default:f((()=>[A])),_:1})])]),null!=h(C)?(d(),c("div",O,[r(U,{data:h(C),border:!0,height:"350",style:{width:"100%"}},{default:f((()=>[(d(!0),c(y,null,x(h(w),((e,l)=>(d(),g(D,{key:l,prop:e.columnName,label:e.columnDesc,width:"150"},{header:f((()=>[r(o,{modelValue:e.columnDesc,"onUpdate:modelValue":l=>e.columnDesc=l,title:"name:"+e.columnName+",desc:"+e.columnDesc},null,8,["modelValue","onUpdate:modelValue","title"])])),_:2},1032,["prop","label"])))),128))])),_:1},8,["data"])])):b("",!0)])),_:1})])}}}),P={style:{"text-align":"right"}},$={style:{"text-align":"center","margin-top":"8px"}},j=m(" 上一项"),Y=m("创建新表"),X=m(" 下一项"),q={class:"dialog-footer"},J=m("关闭"),G=m("生成表"),K=a({name:"TableSelect",emits:["next","gotoBefor"],setup(e,{emit:l}){const a=F(),{fileInfo:s,fileColumns:m,tables:v,tableInfo:b,tableColumnsInfo:_}=u(a),D=[{name:"uuid",title:"uuid",show:!1},{name:"tabsName",title:"表名称",show:!0},{name:"tabsDesc",title:"表注释"},{name:"tabsRows",title:"表数据量"},{name:"sort",title:"排序"}];let T=o(),S=o(!1),U=o(""),I=o();n((()=>{v.value.forEach((e=>{e.uuid==b.value.uuid&&I.value.setCurrentRow(e)}))}));const M=e=>{b.value=e},N=function(e){if(null==T.value||0==T.value.length)return e;{let l=[];return e.forEach((e=>{if(e.tabsName.indexOf(String(T.value))>-1)l.push(e);else{let t=e.tabsDesc;null!=t&&t.indexOf(String(T.value))>-1&&l.push(e)}})),l}},V=w((()=>{let e=new Array;return D.forEach((l=>{(null==l.show||l.show)&&e.push(l)})),e}));function E(){var e;let a={info:{tabsUuid:null==(e=b.value)?void 0:e.uuid},sortList:[{sortIndex:1,sortOrder:"asc",sortName:"sort"}]};t.post("/sysDbmsTabsColsInfo/findAllBySort",a).then((e=>{200==e.code&&(_.value=e.data,l("next"))})).catch((e=>{}))}const L=function(){U.value="CREATE TABLE "+R(s.value.fileName)+"  ( \r\n";for(let e=0;e<m.value.length;e++){const l=m.value[e];U.value+=e>0?"  ,":"   ",U.value+=R(null==l.columnDesc?l.columnName:l.columnDesc)+"  "+l.columnType+" \r\n"}U.value+=" )",S.value=!0},R=function(e){if(null==e)return"未知名称";let l=e;for(l=l.replaceAll(new RegExp(/\.|\(|\)|（|）|\[|\]|{|}|\$|@|!|【|】| |　|；|;/gi),"_");z(l)>30;)l=l.substring(0,l.length-2);return"`"+l+"`"},z=function(e){for(var l,t=0,a=0;a<e.length;a++)(l=e.charCodeAt(a))<127?t++:t+=128<=l&&l<=2047?2:2048<=l&&l<=65535?3:4;return t},H=function(){let e={info:s.value,columns:m.value,sqlText:U.value};t.post("/sysLoadFileInfo/sqlText",e).then((e=>{var l;200==e.code&&(b.value=e.data,T.value=null==(l=b.value)?void 0:l.tabsName,null!=b.value&&v.value.push(b.value),S.value=!1)})).catch((e=>{}))};return(e,l)=>{const t=i("el-input"),a=i("el-col"),u=i("el-row"),o=i("el-table-column"),n=i("el-scrollbar"),s=i("el-button"),_=i("el-dialog");return d(),c(y,null,[p("div",null,[r(u,null,{default:f((()=>[r(a,null,{default:f((()=>[p("div",P,[r(t,{modelValue:h(T),"onUpdate:modelValue":l[0]||(l[0]=e=>C(T)?T.value=e:T=e),autofocus:!0,label:"赛选表",placeholder:"输入表名或者表注释进行筛选。",style:{width:"180px"}},null,8,["modelValue"])])])),_:1})])),_:1}),r(n,{height:"400px"},{default:f((()=>[r(h(k),{ref_key:"singleTableRef",ref:I,data:N(h(v)),"highlight-current-row":!0,style:{width:"100%"},onCurrentChange:M,setCurrentRow:h(b)},{default:f((()=>[(d(!0),c(y,null,x(h(V),((e,l)=>(d(),g(o,{key:l,property:e.name,label:e.title},null,8,["property","label"])))),128))])),_:1},8,["data","setCurrentRow"])])),_:1}),p("div",$,[r(s,{type:"primary",onClick:l[1]||(l[1]=l=>e.$emit("gotoBefor"))},{default:f((()=>[j])),_:1}),r(s,{type:"primary",onClick:L},{default:f((()=>[Y])),_:1}),r(s,{type:"primary",onClick:E},{default:f((()=>[X])),_:1})])]),r(_,{modelValue:h(S),"onUpdate:modelValue":l[4]||(l[4]=e=>C(S)?S.value=e:S=e),title:"Outer Dialog",draggable:""},{default:f((()=>[r(t,{modelValue:h(U),"onUpdate:modelValue":l[2]||(l[2]=e=>C(U)?U.value=e:U=e),rows:h(m).length+3,placeholder:"Please input","show-word-limit":"",type:"textarea"},null,8,["modelValue","rows"])])),footer:f((()=>[p("div",q,[r(s,{onClick:l[3]||(l[3]=e=>C(S)?S.value=!1:S=!1)},{default:f((()=>[J])),_:1}),r(s,{type:"primary",onClick:H},{default:f((()=>[G])),_:1})])])),_:1},8,["modelValue"])],64)}}});class Q{constructor(){l(this,"M+"),l(this,"d+"),l(this,"H+"),l(this,"m+"),l(this,"s+"),l(this,"q+"),l(this,"S+")}}class W{constructor(){}static formatDate(e,l){const t=new Q;t["M+"]=e.getMonth()+1,t["d+"]=e.getDate(),t["H+"]=e.getHours(),t["m+"]=e.getMinutes(),t["s+"]=e.getSeconds(),t["q+"]=Math.floor((e.getMonth()+3)/3),t["S+"]=e.getMilliseconds(),/(y+)/.test(l)&&(l=l.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(const a in t){const e=a;if(new RegExp("("+a+")").test(l)){let a="";for(let e=0;e<RegExp.$1.length;e++)a+="0";const u=(a+t[e]).substr((""+t[e]).length);l=l.replace(RegExp.$1,1==RegExp.$1.length?t[e].toString():u)}}return l}static getDate(e){return new Date(e)}static getDateTimeStr(e,l){const t=this.getDate(e);l||(l="yyyy-MM-dd HH:mm:ss");return this.formatDate(t,l)}static getDateTimeMsStr(e){const l=this.getDate(e);return this.formatDate(l,"yyyy-MM-dd HH:mm:ss.SSS")}static getAge(e){const l=this.getDate(e),t=new Date;return t.getMonth()<l.getMonth()||t.getMonth()==l.getMonth()&&t.getDay()<l.getDay()?t.getFullYear()-l.getFullYear()-1:t.getFullYear()-l.getFullYear()}static getBmi(e,l){return l/Math.pow(e/100,2)}}class Z{constructor(){}static uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var l=16*Math.random()|0;return("x"==e?l:3&l|8).toString(16)}))}}const ee=e=>(S("data-v-da0b4c02"),e=e(),U(),e),le={id:"columnsMapping"},te={class:"boder-box"},ae={class:"head-box"},ue=ee((()=>p("div",{class:"title"},"文件名",-1))),oe=m("序号"),ne=m("标题名"),se={class:"row-box"},ie=["onClick"],de={class:"boder-box"},ce={class:"head-box"},re=ee((()=>p("div",{class:"title"},"表名称",-1))),fe=m("序号"),pe=m("字段名"),me=m("字段注释"),ve={class:"row-box"},he=["onClick"],ge={class:"button-box"},be=m("猜一猜"),ye=m("添加关系 >"),xe=m(" < 移除关系"),_e=m(" << 全部移除"),we={class:"boder-box"},Ce=ee((()=>p("div",{class:"head-box"},[p("div",{class:"title"},"映射关系")],-1))),ke=m("标题名"),De=m("字段名"),Te=m("字段注释"),Se={class:"row-box"},Ue=["onClick"],Ie={style:{"text-align":"center","margin-top":"8px"}},Me=m(" 上一项"),Ne=m("确认配置信息"),Ve=m(" 下一项");var Ee=D(a({name:"ColumnsMapping",emits:["next","gotoBefor"],setup(e,{emit:l}){const a=F(),{fileInfo:n,fileColumns:s,fileColsMapping:g,tableInfo:b,tableColumnsInfo:w}=u(a);let C=o({uuid:"",fileUuid:"",columnName:""}),k=o({uuid:""}),D=o({uuid:""});const S=function(){let e=[];return s.value.forEach((l=>{let t=!0;g.value.forEach((e=>{e.fileColumnUuid==l.uuid&&e.fileUuid==l.fileUuid&&(t=!1)})),t&&e.push(l)})),e},U=function(){let e=[];return w.value.forEach((l=>{let t=!0;g.value.forEach((e=>{e.tabsColumnUuid==l.uuid&&e.tabsUuid==l.tabsUuid&&(t=!1)})),t&&e.push(l)})),e},M=function(e){let l="";return s.value.forEach((t=>{t.uuid==e&&(l=null==t.columnDesc?t.columnName:t.columnDesc)})),l},N=function(e){let l="";return w.value.forEach((t=>{t.uuid==e&&(l=t.colsName)})),l},V=function(e){let l=null;return w.value.forEach((t=>{t.uuid==e&&(l=t.colsDesc)})),l};function E(){s.value.forEach((e=>{w.value.forEach((l=>{var t;if(e.columnName.indexOf(String(l.colsName))>-1||e.columnName.indexOf(String(l.colsDesc))>-1||null!=e.columnDesc&&String(e.columnDesc).indexOf(String(l.colsDesc))>-1||null!=e.columnDesc&&String(e.columnDesc).indexOf(String(l.colsName))>-1){let a=!0;g.value.forEach((t=>{t.fileColumnUuid!=e.uuid&&t.tabsColumnUuid!=l.uuid||(a=!1)})),a&&g.value.push({uuid:Z.uuid(),fileColumnUuid:e.uuid,fileUuid:n.value.uuid,tabsUuid:null==(t=b.value)?void 0:t.uuid,tabsColumnUuid:l.uuid,sort:e.sort,createTime:W.formatDate(new Date,"yyyy-MM-dd HH:mm:ss"),deleteFlag:0})}}))}))}function L(){var e;let l=!0;g.value.forEach((e=>{e.fileColumnUuid!=C.value.uuid&&e.tabsColumnUuid!=k.value.uuid||(l=!1)})),l&&g.value.push({uuid:Z.uuid(),fileColumnUuid:C.value.uuid,fileUuid:n.value.uuid,tabsUuid:null==(e=b.value)?void 0:e.uuid,tabsColumnUuid:k.value.uuid,sort:C.value.sort,createTime:W.formatDate(new Date,"yyyy-MM-dd HH:mm:ss"),deleteFlag:0})}function R(){for(let e=0;e<g.value.length;e++){g.value[e].uuid==D.value.uuid&&g.value.splice(e,1)}}function z(){g.value=[]}function H(){const e=I.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});let a={fileInfo:n.value,mappings:g.value};t.post("/sysLoadFileColsMapping/saveFileMappingConfig",a).then((t=>{200==t.code&&setTimeout((function(){_({message:t.data,type:"success"}),e.close(),setTimeout((function(){l("next")}),1e3)}),3e3)})).catch((e=>{}))}return(e,l)=>{const t=i("el-col"),a=i("el-row"),u=i("el-scrollbar"),o=i("el-button");return d(),c("div",le,[r(a,{class:"select-row"},{default:f((()=>[r(t,{span:5},{default:f((()=>[p("div",te,[p("div",ae,[ue,p("span",null,v(h(n).fileName),1)]),r(a,{class:"col-head"},{default:f((()=>[r(t,{span:6},{default:f((()=>[oe])),_:1}),r(t,{span:12},{default:f((()=>[ne])),_:1})])),_:1}),p("div",se,[r(u,{height:"400px"},{default:f((()=>[(d(!0),c(y,null,x(S(),((e,l)=>(d(),c("div",{key:l,class:T(e.uuid==h(C).uuid?"select-column-row":"row-text"),onClick:l=>{return t=e,void(C.value=t);var t}},[r(a,null,{default:f((()=>[r(t,{span:6,class:"col-num"},{default:f((()=>[m(v(e.sort),1)])),_:2},1024),r(t,{span:12},{default:f((()=>[m(v(e.columnDesc),1)])),_:2},1024)])),_:2},1024)],10,ie)))),128))])),_:1})])])])),_:1}),r(t,{span:7},{default:f((()=>{var e;return[p("div",de,[p("div",ce,[re,p("span",null,v(null==(e=h(b))?void 0:e.tabsName),1)]),r(a,{class:"col-head"},{default:f((()=>[r(t,{span:4},{default:f((()=>[fe])),_:1}),r(t,{span:10},{default:f((()=>[pe])),_:1}),r(t,{span:10},{default:f((()=>[me])),_:1})])),_:1}),p("div",ve,[r(u,{height:"400px"},{default:f((()=>[(d(!0),c(y,null,x(U(),((e,l)=>(d(),c("div",{class:T(["row-text",e.uuid==h(k).uuid?"select-column-row":"row-text"]),key:l,onClick:l=>function(e){k.value=e}(e)},[r(a,null,{default:f((()=>[r(t,{span:4,class:"col-num"},{default:f((()=>[m(v(e.sort),1)])),_:2},1024),r(t,{span:10},{default:f((()=>[m(v(e.colsName),1)])),_:2},1024),r(t,{span:10},{default:f((()=>[m(v(e.colsDesc),1)])),_:2},1024)])),_:2},1024)],10,he)))),128))])),_:1})])])]})),_:1}),r(t,{span:2},{default:f((()=>[p("div",ge,[r(a,null,{default:f((()=>[r(t,{span:24},{default:f((()=>[r(o,{color:"#626aef",plain:"",onClick:E},{default:f((()=>[be])),_:1})])),_:1}),r(t,{span:24},{default:f((()=>[r(o,{color:"#626aef",plain:"",onClick:L},{default:f((()=>[ye])),_:1})])),_:1}),r(t,{span:24},{default:f((()=>[r(o,{color:"#626aef",plain:"",onClick:R},{default:f((()=>[xe])),_:1})])),_:1}),r(t,{span:24},{default:f((()=>[r(o,{color:"#626aef",plain:"",onClick:z},{default:f((()=>[_e])),_:1})])),_:1})])),_:1})])])),_:1}),r(t,{span:10},{default:f((()=>[p("div",we,[Ce,r(a,{class:"col-head"},{default:f((()=>[r(t,{span:6},{default:f((()=>[ke])),_:1}),r(t,{span:6},{default:f((()=>[De])),_:1}),r(t,{span:6},{default:f((()=>[Te])),_:1})])),_:1}),p("div",Se,[r(u,{height:"400px"},{default:f((()=>[(d(!0),c(y,null,x(h(g),((e,l)=>(d(),c("div",{class:T(["row-text",e.uuid==h(D).uuid?"select-column-row":"row-text"]),key:l,onClick:l=>function(e){D.value=e}(e)},[r(a,null,{default:f((()=>[r(t,{span:6},{default:f((()=>[m(v(M(e.fileColumnUuid)),1)])),_:2},1024),r(t,{span:6},{default:f((()=>[m(v(N(e.tabsColumnUuid)),1)])),_:2},1024),r(t,{span:6},{default:f((()=>[m(v(V(e.tabsColumnUuid)),1)])),_:2},1024)])),_:2},1024)],10,Ue)))),128))])),_:1})])])])),_:1})])),_:1}),p("div",Ie,[r(o,{type:"primary",onClick:l[0]||(l[0]=l=>e.$emit("gotoBefor"))},{default:f((()=>[Me])),_:1}),r(o,{type:"primary",onClick:H},{default:f((()=>[Ne])),_:1}),r(o,{type:"primary",onClick:l[1]||(l[1]=l=>e.$emit("next"))},{default:f((()=>[Ve])),_:1})])])}}}),[["__scopeId","data-v-da0b4c02"]]);const Fe=a({name:"ColumnSet",emits:["showPage"],setup(e,{emit:l}){const t=o(0),a=function(){setTimeout((function(){l("showPage","2")}),300)};return(e,l)=>{const u=i("el-step"),o=i("el-steps"),n=i("el-card"),s=i("el-collapse-transition"),c=i("el-space");return d(),g(c,{fill:!0,wrap:"",style:{width:"95%","text-align":"center"}},{default:f((()=>[r(n,{class:"box-card"},{default:f((()=>[r(o,{active:t.value,"finish-status":"success",simple:"",style:{"margin-top":"20px"}},{default:f((()=>[r(u,{title:"文件处理",description:"文件数据格式配置"}),r(u,{title:"表选择",description:"对应导入表选择"}),r(u,{title:"映射关系",description:"字段关系，格式化处理"})])),_:1},8,["active"])])),_:1}),r(n,{class:"box-card"},{default:f((()=>[r(s,null,{default:f((()=>[0==t.value?(d(),g(B,{key:0,onNext:l[0]||(l[0]=e=>t.value=1)})):b("",!0),1==t.value?(d(),g(K,{key:1,onNext:l[1]||(l[1]=e=>t.value=2),onGotoBefor:l[2]||(l[2]=e=>t.value=0)})):b("",!0),2==t.value?(d(),g(Ee,{key:2,onNext:a,onGotoBefor:l[3]||(l[3]=e=>t.value=1)})):b("",!0)])),_:1})])),_:1})])),_:1})}}}),Le={style:{"text-align":"right"}},Re=m("重启"),ze=m("停止"),He=m("继续"),Ae=m("修改配置"),Oe=a({name:"FileLogs",emits:["showPage"],setup(e,{emit:l}){const a=F(),{fileInfo:n}=u(a);let s={pageNumber:1,sizes:[10,20,50,100],pageSize:10,totalElements:0,info:{},searchList:[{operator:"and",column:"fileUuid",title:"删除",symbol:"eq",data:n.value.uuid,showdata:!0}],sortList:[{sortIndex:2,sortTitle:"createTime",sortOrder:"desc",sortName:"createTime"}]},m=o(!0),v=o([]),b=null,y=o(""),x=o("VideoPlay");function w(){t.post("/sysLoadFileLogInfo/page",s).then((e=>{200==e.code&&(v.value=e.data.content,s.totalElements=e.data.totalElements),m.value=!1})).catch((e=>{}))}function C(){t.post("/sysLoadFileLogInfo/reStartJob",n.value).then((e=>{200==e.code&&(_({message:e.data,type:"success"}),setTimeout((function(){w()}),1e3))})).catch((e=>{}))}function k(){t.post("/sysLoadFileLogInfo/stopJob",n.value).then((e=>{200==e.code&&(_({message:e.data,type:"success"}),setTimeout((function(){w()}),1e3))})).catch((e=>{}))}function D(){t.post("/sysLoadFileLogInfo/continueJob",n.value).then((e=>{200==e.code&&(_({message:e.data,type:"success"}),setTimeout((function(){w()}),1e3))})).catch((e=>{}))}function T(e){s.pageSize=e,w()}function S(e){s.pageNumber=e,w()}function U(){l("showPage","1")}return M((()=>{w()})),(e,l)=>{const t=i("el-button"),a=i("el-button-group"),u=i("el-col"),o=i("el-row"),n=i("el-table-column"),_=i("el-table"),I=i("el-pagination"),M=i("el-card"),F=i("el-space"),L=N("loading");return d(),c("div",null,[r(F,{fill:!0,wrap:"",style:{width:"95%","text-align":"center"}},{default:f((()=>[r(M,{class:"box-card"},{default:f((()=>[r(o,null,{default:f((()=>[r(u,{span:24},{default:f((()=>[p("div",Le,[r(a,null,{default:f((()=>[r(t,{type:"info",onClick:C},{default:f((()=>[Re])),_:1}),r(t,{type:"info",onClick:k},{default:f((()=>[ze])),_:1}),r(t,{type:"info",onClick:D},{default:f((()=>[He])),_:1})])),_:1}),r(t,{type:"info",onClick:U},{default:f((()=>[Ae])),_:1}),r(t,{title:"刷新，每5s自动更新一次",onClick:l[0]||(l[0]=V((e=>{null==b?(b=setInterval(w,5e3),y.value="#626aef",x.value="VideoPause"):(clearInterval(b),y.value="",x.value="VideoPlay",b=null)}),["prevent"])),circle:"",icon:h(x),size:"small",color:h(y)},null,8,["icon","color"])])])),_:1})])),_:1}),E((d(),g(_,{id:"tableid",data:h(v),style:{width:"100%"}},{default:f((()=>[r(n,{type:"index",label:"行号",width:"50"}),r(n,{prop:"rowCount",label:"当前行",width:"150"}),r(n,{prop:"complateRows",label:"执行提交行",width:"150"}),r(n,{prop:"errorRows",label:"执行失败行",width:"150"}),r(n,{prop:"errorMessage",label:"失败消息",width:"150"}),r(n,{prop:"errorFile",label:"失败文件保存位置"}),r(n,{prop:"runState",label:"状态",width:"150"}),r(n,{prop:"createTime",label:"创建时间",width:"150"}),r(n,{prop:"updateTime",label:"更新时间",width:"150"})])),_:1},8,["data"])),[[L,h(m)]]),r(o,null,{default:f((()=>[r(u,{span:12,offset:12},{default:f((()=>[r(I,{class:"pagex",style:{float:"right"},background:"",onSizeChange:T,onCurrentChange:S,"current-page":h(s).pageNumber,"page-sizes":h(s).sizes,"page-size":h(s).pageSize,"pager-count":5,layout:"total, sizes, prev, pager, next, jumper",total:h(s).totalElements,"hide-on-single-page":!0},null,8,["current-page","page-sizes","page-size","total"])])),_:1})])),_:1})])),_:1})])),_:1})])}}});const Be={id:"load-conf"},Pe={class:"title"};var $e=D(a({name:"Index",setup(e){const l=F(),{fileInfo:a,fileColumns:n,fileColsMapping:s,tables:c,tableInfo:r,tableColumnsInfo:m}=u(l);let y=o(),x=o("配置信息");M((()=>{_(),T()}));const _=function(){switch(n.value=[],s.value=[],c.value=[],r.value={uuid:"",tabsName:""},m.value=[],a.value.fileMappingState){case"未配置":x.value="配置信息",w();break;case"配置完":y.value="2",x.value="日志信息",D()}},w=function(){let e={info:{fileUuid:a.value.uuid},sortList:[{sortIndex:1,sortOrder:"asc",sortName:"sort"}]};t.post("/sysLoadFileColsInfo/findAllBySort",e).then((e=>{200==e.code&&e.data.length>0?(n.value=e.data,null!=e.data&&e.data.length>0&&C()):y.value="1"})).catch((e=>{}))},C=function(){let e={fileUuid:a.value.uuid};t.post("/sysLoadFileColsMapping/findAll",e).then((e=>{200==e.code&&e.data.length>0?(s.value=e.data,null!=e.data&&k()):y.value="1"})).catch((e=>{}))},k=function(){let e={uuid:s.value[0].tabsUuid};t.post("/sysDbmsTabsTableInfo/findOne",e).then((e=>{200==e.code&&null!=e.data&&(r.value=e.data,y.value="1")})).catch((e=>{}))},D=function(){},T=function(){t.post("/sysDbmsTabsTableInfo/findAll",{}).then((e=>{200==e.code&&(c.value=e.data)})).catch((e=>{}))},S=function(e){y.value=e,"1"==y.value?x.value="配置信息":x.value="日志信息"};return(e,l)=>{const t=i("el-collapse-transition");return d(),g(t,null,{default:f((()=>[p("div",Be,[p("h1",Pe,v(h(x)),1),"1"==h(y)?(d(),g(Fe,{key:0,onShowPage:S})):b("",!0),"2"==h(y)?(d(),g(Oe,{key:1,onShowPage:S})):b("",!0)])])),_:1})}}}),[["__scopeId","data-v-5e796d64"]]);export{$e as default};
